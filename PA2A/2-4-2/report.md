# PA2-4-2解题报告

## 使用的数据结构和算法

本题要求维护区间和，支持区间修改和区间查询，由于值域较大而不要求在线，因此采用离散化后开线段树的方法。

## 遇到的问题和解决方案

离散化后线段树的叶子节点维护的内容最初考虑仍然是一个左闭右闭的区间，但这样会导致有些情况下漏掉一些点。

改为每个叶子节点l == r - 1，维护第l个标记到第r个标记的左闭右开区间区间和即可。为了在左闭右开的情况下仍然支持题目的查询和修改，应该调整区间右端点使其加一。

但是0x7fffffff加一后会int溢出，因此改为将左端点减一。

## 时空复杂度估算

建树过程的时空复杂度均为O(M)。

每次查询复杂度不超过O(logM)，因此总时间复杂度为O(MlogM)，总空间复杂度O(M)。
